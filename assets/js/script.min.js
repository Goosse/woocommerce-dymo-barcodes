!function($){function e(){t(),a()}function t(){var e=wcb_params.label_size,t=$("#woocommerce_product_barcodes_label_size");t.length&&(e=t.val()),n(e)}function a(){for(var e=$("#woocommerce_product_barcodes_dymo_printer"),t=dymo.label.framework.getLabelWriterPrinters(),a=0;a<t.length;++a){var n=t[a],r=n.name,o=$("<option>").val(r).text(r);e.append(o)}}function n(e){$.get(wcb_params.plugin_url+"/assets/labels/"+e+".label",function(e){d=dymo.label.framework.openLabelXml(e),i(),c()},"text")}function r(e,t){try{if(!d)throw wcb_params.label_loaded_error;if(!u)throw wcb_params.data_loaded_error;d.print(wcb_params.dymo_printer,null,e)}catch(t){alert(t.message||t)}}function o(){var e=new dymo.label.framework.LabelSetBuilder;return $(".wcb_barcodes").each(function(t,a){for(var n=$(this),r=n.find("input.product-name").val(),o=n.find("input.product-barcode").val(),c=n.find("input.product-metadata").val(),i=n.find("input.product-label-input").val(),d=0;i>d;d++){console.log(r+" : "+c+" : "+o);var u=e.addRecord();u.setText("product_name",r),u.setText("metadata",$.trim(c)),u.setText("product_barcode",o)}}),e}function c(){var e=$("#woocommerce-dymo-print-preview-img"),t=d.render();e.attr("src","data:image/png;base64,"+t)}function i(){var e=$(".metadata:checked").map(function(){return $.trim($(this).parent().text())}).get().join(" "),t=$(".name:checked").map(function(){return $.trim($(this).parent().text())}).get().join(" "),a=$(".barcode:checked").map(function(){return $.trim("1234")}).get().join(" ");d.setObjectText("metadata",e),d.setObjectText("product_name",t),d.setObjectText("product_barcode",a)}var d,u,l,p=1;$(window).on("load",e),$(document).on("change","#woocommerce_product_barcodes_label_size",function(){var e=$(this).val();n(e)}),$(document).on("change",".label-preview-option",function(){i(),c()}),$(document).on("change keyup",".product-label-input",function(){var e=0,t=$("#wcb_print_btn");$(".product-label-input").each(function(){e+=Number($(this).val()),wcb_params.dymo_printer&&(e>0?t.prop("disabled",!1).find("span").text(e):t.prop("disabled",!0).find("span").text(""))})}),$(document).on("click","#wcb_print_btn",function(e){return e.preventDefault(),u=o(),r(u,e),!1})}(jQuery);